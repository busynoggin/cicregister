plugin.tx_cicregister {
	view {
		templateRootPath = {$plugin.tx_cicregister.view.templateRootPath}
		partialRootPath = {$plugin.tx_cicregister.view.partialRootPath}
		layoutRootPath = {$plugin.tx_cicregister.view.layoutRootPath}
	}
	settings {
		views {
			new {
				disableAjax = 0
				formTargetPid = {$plugin.tx_cicregister.settings.pids.newView}
			}
		}
		defaults {
			globalGroupId = {$plugin.tx_cicregister.settings.uids.globalGroupId}
		}
		pids {
			editView = {$plugin.tx_cicregister.settings.pids.editView}
		}
		login {
			returnMessages {
				1 = This is a sample redirect message. Reference the key in the &return_msg GET/POST variable.
			}
			allowForgotPassword = 1
			honorRedirectUrlArgument = 1
			postLoginRedirectPid = {$plugin.tx_cicregister.settings.pids.logoutPid}
		}
		behaviors {
			login {
				forgotPassword {
					Tx_Cicregister_Behaviors_SendForgotPasswordEmail = 1
					Tx_Cicregister_Behaviors_SendForgotPasswordEmail {
						senderEmail = {$plugin.tx_cicregister.settings.email.senderEmail}
						senderName = {$plugin.tx_cicregister.settings.email.senderName}
						validateSubject = {$plugin.tx_cicregister.settings.email.subjects.forgotPassword}
						variables {
							siteName = {$plugin.tx_cicregister.settings.strings.siteName}
							validatePid = {$plugin.tx_cicregister.settings.pids.editView}
						}
					}
				}
			}
			frontendUser {
				emailValidationSuccess {
					Tx_Cicregister_Behaviors_SyncToSalesforce = 0
				}
				emailValidationFailure {
				}
				updated {
					Tx_Cicregister_Behaviors_SyncToSalesforce = 0
				}
				created {
					Tx_Cicregister_Behaviors_SendValidationEmail = 1
					Tx_Cicregister_Behaviors_SendValidationEmail {
						senderEmail = {$plugin.tx_cicregister.settings.email.senderEmail}
						senderName = {$plugin.tx_cicregister.settings.email.senderName}
						validateSubject = {$plugin.tx_cicregister.settings.email.subjects.validateAccount}
						variables {
							siteName = {$plugin.tx_cicregister.settings.strings.siteName}
							validatePid = {$plugin.tx_cicregister.settings.pids.editView}
						}
					}
					Tx_Cicregister_Behaviors_AddFlashMessage = 0
					Tx_Cicregister_Behaviors_AddFlashMessage {
						severity =
						title = Sign-up Successful!
						message = Thank you for signing up with {$plugin.tx_cicregister.settings.strings.siteName}
					}
					Tx_Cicregister_Behaviors_AuthenticateUser = 1
					Tx_Cicregister_Behaviors_AuthenticateUser {
						forwardAction =
						forwardPid = {$plugin.tx_cicregister.settings.pids.loginPid}
						feuserPid =  {$plugin.tx_cicregister.settings.pids.storagePid}
					}
				}
			}
		}
		decorators {
			frontendUser {
				created {
					Tx_Cicregister_Decorators_Disable = 0
					Tx_Cicregister_Decorators_AddToGroup = 1
					Tx_Cicregister_Decorators_AddToGroup {
						groupUid = {$plugin.tx_cicregister.settings.uids.unvalidatedGroupId}
					}
				}
				emailValidated {
					Tx_Cicregister_Decorators_Enable = 1
					Tx_Cicregister_Decorators_AddToGroup {
						groupUid = {$plugin.tx_cicregister.settings.uids.validatedGroupId}
					}
					Tx_Cicregister_Decorators_RemoveFromGroup = 1
					Tx_Cicregister_Decorators_RemoveFromGroup {
						groupUid = {$plugin.tx_cicregister.settings.uids.unvalidatedGroupId}
					}
				}
				edited {
				}
			}
		}
	}
	persistence {
		storagePid = {$plugin.tx_cicregister.settings.pids.storagePid}
	}
	features {
		rewrittenPropertyMapper = 1
	}
}

config.tx_extbase {
	objects {
		Tx_Extbase_Domain_Repository_FrontendUserRepository {
			className = Tx_Cicregister_Domain_Repository_GlobalFrontendUserRepository
		}
	}
	persistence {
		classes {
			Tx_Extbase_Domain_Model_FrontendUserGroup {
				mapping {
					tableName = fe_groups
					recordType = Tx_Extbase_Domain_Model_FrontendUserGroup
				}
				subclasses {
					Tx_Cicregister_Domain_Model_FrontendUserGroup = Tx_Cicregister_Domain_Model_FrontendUserGroup
				}
			}
			Tx_Extbase_Domain_Model_FrontendUser {
				mapping {
					tableName = fe_users
					recordType = Tx_Extbase_Domain_Model_FrontendUser
					columns {
						lockToDomain.mapOnProperty = lockToDomain
					}
				}
				subclasses {
					Tx_Cicregister_Domain_Model_FrontendUser = Tx_Cicregister_Domain_Model_FrontendUser
				}
			}
			Tx_Cicregister_Domain_Model_FrontendUserGroup {
				mapping {
					tableName = fe_groups
					recordType = Tx_Cicregister_Domain_Model_FrontendUserGroup
					columns {
						tx_cicregister_enrollment_code.mapOnProperty = enrollmentCode
					}
				}
			}
			Tx_Cicregister_Domain_Model_FrontendUser {
				mapping {
					tableName = fe_users
					recordType = Tx_Cicregister_Domain_Model_FrontendUser
					columns {
						tx_cicregister_sfdc_contact_id.mapOnProperty = sfdcContactID
						tx_cicregister_sfdc_lead_id.mapOnProperty = sfdcLeadID
						tx_cicregister_sfdc_sync_timestamp.mapOnProperty = sfdcSyncTimestamp
					}
				}
			}
		}
	}
}

Tx_Cicregister_JSON_RequestPage = PAGE
Tx_Cicregister_JSON_RequestPage {
    typeNum = {$plugin.tx_cicregister.settings.eidTypeNum}
    config {
        disableAllHeaderCode = 1
        xhtml_cleaning = 0
        admPanel = 0
            debug = 0
            no_cache = 1
        additionalHeaders = Content-type:application/json
    }
	10 = USER_INT
	10 {
		userFunc = tx_extbase_core_bootstrap->run
		extensionName = Cicregister
		pluginName = Create
		switchableControllerActions {
			FrontendUserJSON {
				1 = create
				2 = createConfirmationMustValidate
			}
		}
	}
}

page.includeCSS {
}

page.includeJSFooterlibs {
}

page.includeJSFooter {
}

plugin.tx_cicregister._CSS_DEFAULT_STYLE (
)