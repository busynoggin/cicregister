plugin.tx_cicregister {
	view {
		templateRootPath = {$plugin.tx_cicregister.view.templateRootPath}
		partialRootPath = {$plugin.tx_cicregister.view.partialRootPath}
		layoutRootPath = {$plugin.tx_cicregister.view.layoutRootPath}
	}
	settings {
		defaults {
			groupUid = {$plugin.tx_cicregister.settings.defaults.groupUid}
		}
		pids {
			editView = {$plugin.tx_cicregister.settings.pids.editView}
		}
		behaviors {
			frontendUser {
				emailValidationSuccess {
					Tx_Cicregister_Behaviors_SyncToSalesforce = 0
				}
				emailValidationFailure {
				}
				updated {
					Tx_Cicregister_Behaviors_SyncToSalesforce = 0
				}
				created {
					Tx_Cicregister_Behaviors_SendValidationEmail = 0
					Tx_Cicregister_Behaviors_SendValidationEmail {
						senderEmail = typo3@yourdomain.com
						senderName = Main Dish & Son
						validateSubject = Main Dish & Son: Please confirm your registration
						variables {
							siteName = MainDish & Son
							validatePid = 80
						}
					}

					Tx_Cicregister_Behaviors_AddFlashMessage = 0
					Tx_Cicregister_Behaviors_AddFlashMessage {
						message (
							Your message goes here...
						)
					}

					Tx_Cicregister_Behaviors_AuthenticateUser = 1
					Tx_Cicregister_Behaviors_AuthenticateUser {
						forwardAction = edit
						forwardPid = {$plugin.tx_cicregister.settings.pid.edirtView}
						feuserPid = {$plugin.tx_cicregister.persistence.storagePid}
					}
				}
			}
		}
		decorators {
			frontendUser {
				created {
					Tx_Cicregister_Decorators_Disable = 0
					Tx_Cicregister_Decorators_AddToGroup = 1
					Tx_Cicregister_Decorators_AddToGroup {
						groupUid = 	{$plugin.tx_cicregister.decorators.created.addToGroup.groupUid}
					}
				}
				emailValidated {
					Tx_Cicregister_Decorators_Enable = 0
					Tx_Cicregister_Decorators_AddToGroup {
						groupUid = 	{$plugin.tx_cicregister.decorators.emailValidated.addToGroup.groupUid}
					}
					Tx_Cicregister_Decorators_RemoveFromGroup = 1
					Tx_Cicregister_Decorators_RemoveFromGroup {
						groupUid = 	{$plugin.tx_cicregister.decorators.emailValidate.removeFromGroup.groupUid}
					}
				}
				edited {

				}
			}
		}
	}
	persistence {
		storagePid = {$plugin.tx_cicregister.persistence.storagePid}
		//TODO: remove at some point
		storagePid = 4, 132
	}
	features {
		rewrittenPropertyMapper = 1
	}
}

config.tx_extbase {
	objects {
		Tx_Extbase_Domain_Repository_FrontendUserRepository {
			className = Tx_Cicregister_Domain_Repository_GlobalFrontendUserRepository
		}
	}
	persistence {
		classes {
			Tx_Extbase_Domain_Model_FrontendUserGroup {
				mapping {
					tableName = fe_groups
					recordType = Tx_Extbase_Domain_Model_FrontendUserGroup
				}
				subclasses {
					Tx_Cicregister_Domain_Model_FrontendUserGroup = Tx_Cicregister_Domain_Model_FrontendUserGroup
				}
			}
			Tx_Extbase_Domain_Model_FrontendUser {
				mapping {
					tableName = fe_users
					recordType = Tx_Extbase_Domain_Model_FrontendUser
					columns {
						lockToDomain.mapOnProperty = lockToDomain
					}
				}
				subclasses {
					Tx_Cicregister_Domain_Model_FrontendUser = Tx_Cicregister_Domain_Model_FrontendUser
				}
			}
			Tx_Cicregister_Domain_Model_FrontendUserGroup {
				mapping {
					tableName = fe_groups
					recordType = Tx_Cicregister_Domain_Model_FrontendUserGroup
				}
			}
			Tx_Cicregister_Domain_Model_FrontendUser {
				mapping {
					tableName = fe_users
					recordType = Tx_Cicregister_Domain_Model_FrontendUser
					columns {
						tx_cicregister_sfdc_contact_id.mapOnProperty = sfdcContactID
						tx_cicregister_sfdc_lead_id.mapOnProperty = sfdcLeadID
						tx_cicregister_sfdc_sync_timestamp.mapOnProperty = sfdcSyncTimestamp
					}
				}
			}
		}
	}
}

Tx_Cicregister_JSON_RequestPage = PAGE
Tx_Cicregister_JSON_RequestPage {
    typeNum = 1325527064
    config {
        disableAllHeaderCode = 1
        xhtml_cleaning = 0
        admPanel = 0
            debug = 0
            no_cache = 1
        additionalHeaders = Content-type:application/json
    }
	10 = USER_INT
	10 {
		userFunc = tx_extbase_core_bootstrap->run
		extensionName = Cicregister
		pluginName = Create
		switchableControllerActions {
			FrontendUserJSON {
				1 = create
				2 = createConfirmationMustValidate
			}
		}
	}
}

page.includeCSS {
	99 = EXT:cicregister/Resources/Public/Stylesheet/CicRegisterStyles.css
}

page.includeJSFooter {
	99 = EXT:cicregister/Resources/Public/Javascript/Cicregister.js
}

plugin.tx_cicregister._CSS_DEFAULT_STYLE (
	input.f3-form-error {
		background-color:#FF9F9F;
		border: 1px #FF0000 solid;
	}

	.tx-cicregister table {
		border-collapse:separate;
		border-spacing:10px;
	}

	.tx-cicregister table th {
		font-weight:bold;
	}

	.tx-cicregister table td {
		vertical-align:top;
	}
)